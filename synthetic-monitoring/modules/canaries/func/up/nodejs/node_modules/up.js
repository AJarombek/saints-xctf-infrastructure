/**
 * AWS Synthetic Monitoring Canary function for testing if the SaintsXCTF application is up & running.
 * @author Andrew Jarombek
 * @since 7/5/2021
 */

const synthetics = require('Synthetics');
const log = require('SyntheticsLogger');

const up = async () => {
    log.info('Starting saints-xctf-up canary.');
    const page = await synthetics.getPage();
    const response = await page.goto('https://saintsxctf.com', {waitUntil: 'domcontentloaded', timeout: 30000});

    try {
        if (!response) {
            throw 'Failed to load SaintsXCTF, the website might be down.'
        }
    } finally {
        await synthetics.takeScreenshot('loaded', 'result');
    }
}

exports.handler = async () => {
    return await up();
}